<ng-container *ngIf="view$ | async as view">
    <mat-nav-list *ngIf="view === 'list'; else table">
        <ng-container *ngFor="let item of items">
            <a mat-list-item *ngIf="displayWith(item) as li" [routerLink]="li.link">
                <mat-checkbox
                    *ngIf="!disableSelection"
                    [checked]="selectionModel.isSelected(item)"
                    [value]="item"
                    (change)="onCheckboxChange($event)"
                    (click)="$event.stopPropagation()">
                </mat-checkbox>
                {{ li.title }}
            </a>
        </ng-container>
    </mat-nav-list>
    <ng-template #table>
        <table mat-table [dataSource]="dataSource">
            <ng-container matColumnDef="select">
                <th mat-header-cell *matHeaderCellDef>
                    <mat-checkbox
                    (change)="$event ? masterToggle() : null"
                    [checked]="selectionModel.hasValue() && isAllSelected()"
                    [indeterminate]="selectionModel.hasValue() && !isAllSelected()"
                    >
                    </mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let row">
                    <mat-checkbox
                        (click)="$event.stopPropagation()"
                        (change)="$event ? selectionModel.toggle(row) : null"
                        [checked]="selectionModel.isSelected(row)">
                    </mat-checkbox>
                </td>
            </ng-container>
            <ng-container *ngFor="let column of allColumns; first as isFirst" [matColumnDef]="column">
                <th mat-header-cell *matHeaderCellDef>{{ column | titlecase }}</th>
                <td mat-cell *matCellDef="let item">
                    <a
                        *ngIf="isFirst; else plain"
                        [routerLink]="displayWith(item).link"
                        (click)="$event.stopPropagation()">
                        {{ value(column, item) | titlecase }}
                    </a>
                    <ng-template #plain>
                        {{ value(column, item) | titlecase }}
                    </ng-template>
                </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="allColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: allColumns" (click)="onRowClick(row)"></tr>
        </table>
    </ng-template>
</ng-container>
